<!DOCTYPE html>
<html>
<head>
    <title>Prices</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <nav>
        <b>CryptoTracker</b>
        <div><a href="/trading">Market</a> <a href="/watchlist">Watchlist</a> <a href="/logout">Logout</a></div>
    </nav>
    <div class="container">
        <h2>Market Prices</h2>
        <table>
            <tr>
                <th>Coin</th>
                <th>Price</th>
                <th>Change (24h)</th>
                <th>Market Cap</th>
                <th>Action</th>
            </tr>
            {% for coin in cryptos %}
            <tr>
                <td>
                    <img src="{{ coin.image }}" width="20">
                    <a href="/crypto/{{ coin.symbol }}">{{ coin.name }}</a>
                </td>
                <td>${{ coin.current_price }}</td>
                <td style="color: {{ 'green' if coin.price_change_percentage_24h > 0 else 'red' }}">
                    {{ coin.price_change_percentage_24h }}%
                </td>
                <td>${{ coin.market_cap }}</td>
                <td><button onclick="add('{{ coin.symbol }}')" class="btn-sm">Watch</button></td>
            </tr>
            {% endfor %}
        </table>
    </div>
    <script>
        function add(s) {
            fetch('/add_to_watchlist', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({symbol: s})
            }).then(r => r.json()).then(d => alert(d.message));
        }
    </script>
</body>
</html>